<script type="text/javascript" charset="utf-8">  $(document).ready(function() {    new Highcharts.Chart({      chart: { type: "scatter", renderTo: "results-chart" },      title: { text: "Results by Age" },    credits: { enabled: false },    tooltip: { formatter: function() { return this.point.name; } },      yAxis: { title: { text: "Minutes" }, lineWidth: 1 },      xAxis: { title: { text: "Age" } },     legend: { align: 'right',               verticalAlign: 'top',               x: -10,               y: 50,               floating: true },      series: [    {    name: "male",    data: [    <% @race.results.male.each do |result| %>      <%= "{ name: '#{result.first_name} #{escape_javascript(result.last_name)}', x: #{result.age}, y: #{result.gun_time/60} }," %>    <% end %>    ]    },{    name: 'female',    data: [    <% @race.results.female.each do |result| %>      <%= "{ name: '#{escape_javascript(result.first_name << ' ' << result.last_name)}', x: #{result.age}, y: #{result.gun_time/60} }," %>    <% end %>    ]    }]    });        $("#results-list").hide();        $("#show-list-btn").click(function(event) {      $("#results-list").toggle("blind", null, 500);      $("#results-chart").toggle("blind", null, 500);    });        $("#show-chart-btn").click(function(event) {      $("#results-chart").toggle("blind", null, 500);      $("#results-list").toggle("blind", null, 500);    });        // make the pagination links ajax    $("#results-list .pagination a").live("click", function() {      $.getScript(this.href);      return false;    });  });</script><div class="panel-border">    <h3><%=h @race.name %></h3>    <div class="panel-content">        <p>            <%=h @race.description %>        </p>        <p>            <b>finishers:</b>            <%=h @race.finisher_count %>        </p>        <p>            <b>average male time:</b>            <%=h seconds_to_time(@race.results.male.average('gun_time')) %>        </p>        <p>            <b>average female time:</b>            <%=h seconds_to_time(@race.results.female.average('gun_time')) %>        </p>    </div></div><br><% if @race.results.empty? %>    <h1>load results</h1>    <% form_tag(load_results_url(:race_id => @race), :multipart => true) do %>        <p><label for="datafile">Select File</label> : <%= file_field_tag('datafile') %></p>        <p><label for="first_name_index">first name</label> : <%= text_field_tag('first_name_index') %></p>        <p><label for="last_name_index">last name</label> : <%= text_field_tag('last_name_index') %></p>        <p><label for="city_index">city</label> : <%= text_field_tag('city_index') %></p>        <p><label for="club_index">club</label> : <%= text_field_tag('club_index') %></p>        <p><label for="age_index">age</label> : <%= text_field_tag('age_index') %></p>        <p><label for="bib_index">bib</label> : <%= text_field_tag('bib_index') %></p>        <p><label for="div_index">division</label> : <%= text_field_tag('div_index') %></p>        <p><label for="div_place_index">division place</label> : <%= text_field_tag('div_place_index') %></p>        <p><label for="overall_place_index">overall place</label> : <%= text_field_tag('overall_place_index') %></p>        <p><label for="gun_time_index">gun time</label> : <%= text_field_tag('gun_time_index') %></p>        <p><label for="chip_time_index">chip time</label> : <%= text_field_tag('chip_time_index') %></p>        <p><label for="penalty_time_index">penalty time</label> : <%= text_field_tag('penalty_time_index') %></p>        <%= submit_tag "upload" %>    <% end %><% else %>    <div class="btn-group" data-toggle="buttons-radio">        <button id="show-chart-btn" class="btn active">chart</button>        <button id="show-list-btn" class="btn">list</button>    </div>    <p>        <div id="results-chart" style="width:700px; height:500px;"></div>    </p>    <div id="results-list" class="well">          <%= render('results') %>    </div><% end %>